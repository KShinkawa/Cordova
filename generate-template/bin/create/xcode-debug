#! /usr/bin/env python
import os, sys
from xml.dom.minidom import parse

name = parse(os.path.join(os.curdir, 'www', 'config.xml')).getElementsByTagName('name').pop().firstChild.nodeValue.replace(' ','')
project = os.path.join(os.getcwd(), 'tmp', 'ios', name + '.xcodeproj').replace('/',':')[1:]
# a little applescript to invoke xcode build ceremony that which ultimately creates APP.xcodeproj/project.pbxproj
template = """osascript<<END
tell application "Xcode"
	open "__PROJ__"
	tell project "__NAME__"
		clean
		build
		(* for some reasons, debug will hang even the debug process has completed. 
               The try block is created to suppress the AppleEvent timeout error 
             *)
		try
			debug
		end try
	end tell
	quit
end tell
END
"""
# nobody said life was perfect
applescript = template.replace('__NAME__', name).replace('__PROJ__', project)
os.system(applescript)